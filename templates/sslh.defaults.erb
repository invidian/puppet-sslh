# Default options for sslh initscript
# sourced by /etc/init.d/sslh

RUN=yes

# binary to use: forked (sslh) or single-thread (sslh-select) version
DAEMON=/usr/sbin/sslh

DAEMON_OPTS="--user sslh --listen <%= @listen_address -%>
<%
# Check <param>_address and pass each to the daemon if it's present
# SSH *must* be the first option here, so that sslh defaults to it
[:ssh, :ssl, :openvpn, :http, :xmpp, :tinc]
  .map { |param| [param, instance_variable_get("@#{param}_address")] }
  .reject { |param, value| value.nil? }
  .each do |param, value|
-%>
 --<%= param %> <%= value -%>
<% end -%>
 --pidfile /var/run/sslh/sslh.pid"
